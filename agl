#!/usr/bin/env ruby

# List files *and* directories using ag

require 'set'

dirs = Set.new
IO.popen('ag -g ""') do |ag|
  while line = ag.gets
    dir = File.dirname(line)
    puts dir if dir != '.' and dirs.add? dir
    puts line
  end
end

